<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ediblecity">
<title>ediblecity • ediblecity</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="ediblecity">
<meta property="og:description" content="ediblecity">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ediblecity</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/ediblecity.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/icra/ediblecity/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>ediblecity</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/icra/ediblecity/blob/HEAD/vignettes/ediblecity.Rmd" class="external-link"><code>vignettes/ediblecity.Rmd</code></a></small>
      <div class="d-none name"><code>ediblecity.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/icra/ediblecity" class="external-link">ediblecity</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="set-scenarios-of-urban-agriculture">Set scenarios of urban agriculture<a class="anchor" aria-label="anchor" href="#set-scenarios-of-urban-agriculture"></a>
</h2>
<p>The function <code>set_scenario</code> provides a convenient way to
create randomized scenarios for urban agriculture. We use the
<code>city_example</code> provided with the package that is meant to
serve as example to create a model for a city of interest.</p>
<p>We create one scenario, with 50% of normal gardens, vacant plot,
streets and 75% of rooftops converted to edible_gardens. And with 50% of
created gardens being for commercial purposes. To see the correspondence
between original and urban agriculture elements, see
<code><a href="../reference/set_scenario.html">?set_scenario</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">scenario</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_scenario.html">set_scenario</a></span><span class="op">(</span><span class="va">city_example</span>,</span>
<span>                           pGardens <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                           pVacant <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                           pRooftop <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>                           private_gardens_from <span class="op">=</span> <span class="st">"Normal garden"</span>,</span>
<span>                           vacant_from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Vacant"</span>, <span class="st">"Streets"</span><span class="op">)</span>,</span>
<span>                           rooftop_from <span class="op">=</span> <span class="st">"Rooftop"</span>,</span>
<span>                           pCommercial <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co">#&gt; Only 328 rooftops out of 453 assumed satisfy the 'min_area_rooftop'</span></span></code></pre></div>
<p>The warnings are triggered when there are not elements enough to
fulfill the proportions provided to the function.</p>
<p>in this examples, we use the scenario created with
<code>set_scenario</code>, but all the indicators can be calculated
using an <code>sf</code> object with the same structure as
<code>city_example</code>.</p>
<p>Likewise, all the parameters used by the indicators are defined in
<code>city_land_uses</code>. However, all indicators provide an option
to override this an provide a customized dataframe with the parameters.
The structure of this dataframe is detailed in the documentation of each
function.</p>
</div>
<div class="section level2">
<h2 id="estimate-the-benefits-of-urban-agriculture">Estimate the benefits of urban agriculture<a class="anchor" aria-label="anchor" href="#estimate-the-benefits-of-urban-agriculture"></a>
</h2>
<div class="section level3">
<h3 id="urban-heat-island">Urban Heat Island<a class="anchor" aria-label="anchor" href="#urban-heat-island"></a>
</h3>
<p>The urban heat island indicator can return a summary of values or a
<code>stars</code> object. It needs a raster representing the Sky view
factor. See <code><a href="../reference/UHI.html">?UHI</a></code> for more details. We use the
<code>SVF</code> object provided with the package.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/UHI.html">UHI</a></span><span class="op">(</span><span class="va">scenario</span>, <span class="va">SVF</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;   0.000   0.547   1.012   1.032   1.420   2.587</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/UHI.html">UHI</a></span><span class="op">(</span><span class="va">scenario</span>, <span class="va">SVF</span>, return_raster <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ediblecity_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="runoff-prevention">Runoff prevention<a class="anchor" aria-label="anchor" href="#runoff-prevention"></a>
</h3>
<p>The function <code>runoff_prev</code> returns an estimation of the
runoff in the city after a specific rain event (mm/day). It also
estimates the total rainfall and the rainwater harvested by urban
agriculture.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/runoff_prev.html">runoff_prev</a></span><span class="op">(</span><span class="va">scenario</span><span class="op">)</span></span>
<span><span class="co">#&gt;       runoff     rainfall  rainharvest </span></span>
<span><span class="co">#&gt;     34.66903 108169.04500   1561.50493</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="distance-to-closest-green-area">Distance to closest green area<a class="anchor" aria-label="anchor" href="#distance-to-closest-green-area"></a>
</h3>
<p>The function <code>green_distance</code> computes the distances from
each home in the city to its closest public green area larger than a
specific area. The homes must be identified using the column passed to
<code>residence_col</code>. The default values for minimal area (0.5 ha)
and for maximum distance (300 meters) follow the recommendations of
WHO.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/green_distance.html">green_distance</a></span><span class="op">(</span><span class="va">scenario</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;    6.12  155.08  251.70  249.72  347.42  465.73</span></span></code></pre></div>
<p>If <code>percent_out</code> is set to <code>TRUE</code>, instead of a
summary of distances, it returns the percentage of homes that are
further than <code>max_dist</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/green_distance.html">green_distance</a></span><span class="op">(</span><span class="va">scenario</span>, percent_out <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 36.92615</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="green-per-capita">Green per capita<a class="anchor" aria-label="anchor" href="#green-per-capita"></a>
</h3>
<p>The function <code>green_capita</code> calculates the amount of
public and/or private green are per capita in the city. It can compute
the total of the city, the values for each neighbourhood or the ratio
between the neighbourhoods with minimum and maximum value (min /
max).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/green_capita.html">green_capita</a></span><span class="op">(</span><span class="va">scenario</span>, inhabitants <span class="op">=</span> <span class="fl">6000</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 10.70483</span></span>
<span></span>
<span><span class="fu"><a href="../reference/green_capita.html">green_capita</a></span><span class="op">(</span><span class="va">scenario</span>, </span>
<span>             neighbourhoods <span class="op">=</span> <span class="va">neighbourhoods_example</span>, </span>
<span>             inh_col <span class="op">=</span> <span class="st">'inhabitants'</span>,</span>
<span>             name_col <span class="op">=</span> <span class="st">'name'</span>,</span>
<span>             verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 4</span></span></span>
<span><span class="co">#&gt;   name              area inhabitants green_capita</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Sant Narcís nord <span style="text-decoration: underline;">35</span>517        <span style="text-decoration: underline;">1</span>028        34.5 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Sant Narcís sud  <span style="text-decoration: underline;">34</span>420        <span style="text-decoration: underline;">5</span>290         6.51</span></span>
<span></span>
<span><span class="fu"><a href="../reference/green_capita.html">green_capita</a></span><span class="op">(</span><span class="va">scenario</span>, </span>
<span>             neighbourhoods <span class="op">=</span> <span class="va">neighbourhoods_example</span>, </span>
<span>             inh_col <span class="op">=</span> <span class="st">'inhabitants'</span>,</span>
<span>             name_col <span class="op">=</span> <span class="st">'name'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.1883268</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="nitrogen-dioxide-no2-sequestered-by-urban-green">Nitrogen dioxide (NO<sub>2</sub>) sequestered by urban green<a class="anchor" aria-label="anchor" href="#nitrogen-dioxide-no2-sequestered-by-urban-green"></a>
</h3>
<p>The function <code>no2_seq</code> computes the amount of
NO<sub>2</sub> sequestered by urban green in gr/s.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/no2_seq.html">no2_seq</a></span><span class="op">(</span><span class="va">scenario</span><span class="op">)</span></span>
<span><span class="co">#&gt;     gr/s </span></span>
<span><span class="co">#&gt; 109.4501</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="jobs-created-by-commercial-urban-agriculture">Jobs created by commercial urban agriculture<a class="anchor" aria-label="anchor" href="#jobs-created-by-commercial-urban-agriculture"></a>
</h3>
<p>The function <code>edible_jobs</code> estimates the number of jobs
potentially created by commercial urban agriculture. Since the number of
jobs / m2 is randomized, it computes a Monte Carlo simulation (n=1000)
to estimate the value and returns the confidence interval (unless
<code>verbose = TRUE</code>).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/edible_jobs.html">edible_jobs</a></span><span class="op">(</span><span class="va">scenario</span><span class="op">)</span></span>
<span><span class="co">#&gt;        5%       50%       95% </span></span>
<span><span class="co">#&gt;  192.3673 1569.2654 3231.9199</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="volunteers-involved-in-community-urban-agriculture">Volunteers involved in community urban agriculture<a class="anchor" aria-label="anchor" href="#volunteers-involved-in-community-urban-agriculture"></a>
</h3>
<p>The function <code>edible_volunteers</code> estimates the number of
volunteers potentially involved in community urban agriculture. Since
the number of volunteers / m2 is randomized, it computes a Monte Carlo
simulation (n=1000) to estimate the value and returns the confidence
interval (unless <code>verbose = TRUE</code>).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/edible_volunteers.html">edible_volunteers</a></span><span class="op">(</span><span class="va">scenario</span><span class="op">)</span></span>
<span><span class="co">#&gt;       5%      50%      95% </span></span>
<span><span class="co">#&gt;  282.468 2386.520 4371.657</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="food-production">Food production<a class="anchor" aria-label="anchor" href="#food-production"></a>
</h3>
<p>The function <code>food_production</code> estimates the food produced
by urban agriculture (in kg/year). Since the productivity of each plot
is randomized, It computes a Monte Carlo simulation (n=1000) to estimate
the value and returns the confidence interval (unless
<code>verbose = TRUE</code>).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/food_production.html">food_production</a></span><span class="op">(</span><span class="va">scenario</span><span class="op">)</span></span>
<span><span class="co">#&gt;        5%       50%       95% </span></span>
<span><span class="co">#&gt;  678774.1  905205.6 1139922.3</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="randomization">Randomization<a class="anchor" aria-label="anchor" href="#randomization"></a>
</h2>
<p>The construction of scenarios as well as some parameters in the
indicators are randomized to consider uncertainty. Our recommendation is
to run each scenario you want to simulate in a Monte Carlo simulation to
get the confidence interval for each indicator. You will find a
practical implementation <a href="https://github.com/icra/msn_scenarios/blob/master/R/estimate_scenarios.R" class="external-link">here</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Josep Pueyo-Ros, ICRA - Catalan Institute for Water Research.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
